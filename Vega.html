{
    "$schema": "https://vega.github.io/schema/vega/v5.json",
    "description": "A heatmap showing average daily temperatures in Seattle for each hour of the day.",
    "width": 500,
    "height": 800,
    "padding": 5,
  
    "title": {
      "text": "Energy",
      "anchor": "middle",
      "fontSize": 16,
      "frame": "group",
      "offset": 6
    },
  
    "signals": [
      {"name": "palette", "value": "Viridis"},
      {"name": "reverse", "value": false, "bind": {"input": "checkbox"}}
    ],
  
    "data": [
      {
        "name": "temperature",
        "url": "data/seattle-weather-hourly-normals.csv",
        "format": {"type": "csv", "parse": {"temperature": "number", "date": "date"}},
        "transform": [
          {"type": "formula", "as": "hour", "expr": "hours(datum.date)"},
          { "type": "formula", "as": "day",
            "expr": "datetime(year(datum.date), month(datum.date), date(datum.date))"}
        ]
      }
    ],
  
    
    "scales": [
      {
        "name": "y",
        "type": "time",
        "domain": {"data": "temperature", "field": "day"},
        "range": "height"
      },
      {
        "name": "x",
        "type": "band",
        "domain": [
          0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23 
        ],
        "range": "width"
      },
      {
        "name": "color",
        "type": "linear",
        "range": {"scheme": {"signal": "palette"}},
        "domain": {"data": "temperature", "field": "temperature"},
        "reverse": {"signal": "reverse"},
        "zero": false, "nice": true
      }
    ],
  
    "axes": [
      {"orient": "left", "scale": "y", "domain": false, "title": "Day", "format": "%b"},
      {"orient": "bottom", "scale": "x", "domain": false, "title": "Hour"}
    ],
  
    "legends": [
      {
        "fill": "color",
        "type": "gradient",
        "title": "Consumption (kW)",
        "titleFontSize": 12,
        "titlePadding": 4,
        "gradientLength": {"signal": "300"}
      }
    ],
  
    "marks": [
      {
        "type": "rect",
        "from": {"data": "temperature"},
        "encode": {
          "enter": {
            "y": {"scale": "y", "field": "day"},
            "x": {"scale": "x", "field": "hour"},
            "width": {"value": 20},
            "height": {"scale": "x", "band": 0.1},
            "tooltip": {"signal": "timeFormat(datum.date, '%b %d %I:00 %p') + ': ' + datum.temperature + ' kW'"}
          },
          "update": {
            "fill": {"scale": "color", "field": "temperature"}
          }
        }
      }
    ]
  }